let e,t,i,o,n,a,s,r,l,h,c;import"./buildingAnimation.5423aa82.js";import"./buildingAnimation.bd798f01.js";import"./buildingAnimation.4b8d4fc8.js";var p=globalThis,d={},m={},u=p.parcelRequire1149;null==u&&((u=function(e){if(e in d)return d[e].exports;if(e in m){var t=m[e];delete m[e];var i={id:e,exports:{}};return d[e]=i,t.call(i.exports,i,i.exports),i.exports}var o=Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){m[e]=t},p.parcelRequire1149=u),u.register;var w=u("jw0R5"),y=u("cPutt"),f=u("ihXk0"),M=u("2sw9m"),w=u("jw0R5");let g=new w.Raycaster,x=new w.Vector3,v=new w.Vector3,b=new w.Quaternion,P={X:new w.Vector3(1,0,0),Y:new w.Vector3(0,1,0),Z:new w.Vector3(0,0,1)},S={type:"change"},_={type:"mouseDown"},E={type:"mouseUp",mode:null},C={type:"objectChange"};class I extends w.Object3D{constructor(e,t){super(),void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.isTransformControls=!0,this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";let i=new N;this._gizmo=i,this.add(i);let o=new U;this._plane=o,this.add(o);let n=this;function a(e,t){let a=t;Object.defineProperty(n,e,{get:function(){return void 0!==a?a:t},set:function(t){a!==t&&(a=t,o[e]=t,i[e]=t,n.dispatchEvent({type:e+"-changed",value:t}),n.dispatchEvent(S))}}),n[e]=t,o[e]=t,i[e]=t}a("camera",e),a("object",void 0),a("enabled",!0),a("axis",null),a("mode","translate"),a("translationSnap",null),a("rotationSnap",null),a("scaleSnap",null),a("space","world"),a("size",1),a("dragging",!1),a("showX",!0),a("showY",!0),a("showZ",!0);let s=new w.Vector3,r=new w.Vector3,l=new w.Quaternion,h=new w.Quaternion,c=new w.Vector3,p=new w.Quaternion,d=new w.Vector3,m=new w.Vector3,u=new w.Vector3,y=new w.Vector3;a("worldPosition",s),a("worldPositionStart",r),a("worldQuaternion",l),a("worldQuaternionStart",h),a("cameraPosition",c),a("cameraQuaternion",p),a("pointStart",d),a("pointEnd",m),a("rotationAxis",u),a("rotationAngle",0),a("eye",y),this._offset=new w.Vector3,this._startNorm=new w.Vector3,this._endNorm=new w.Vector3,this._cameraScale=new w.Vector3,this._parentPosition=new w.Vector3,this._parentQuaternion=new w.Quaternion,this._parentQuaternionInv=new w.Quaternion,this._parentScale=new w.Vector3,this._worldScaleStart=new w.Vector3,this._worldQuaternionInv=new w.Quaternion,this._worldScale=new w.Vector3,this._positionStart=new w.Vector3,this._quaternionStart=new w.Quaternion,this._scaleStart=new w.Vector3,this._getPointer=Q.bind(this),this._onPointerDown=X.bind(this),this._onPointerHover=A.bind(this),this._onPointerMove=z.bind(this),this._onPointerUp=Y.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(void 0===this.object||!0===this.dragging)return;g.setFromCamera(e,this.camera);let t=Z(this._gizmo.picker[this.mode],g);t?this.axis=t.object.name:this.axis=null}pointerDown(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){g.setFromCamera(e,this.camera);let t=Z(this._plane,g,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,_.mode=this.mode,this.dispatchEvent(_)}}pointerMove(e){let t=this.axis,i=this.mode,o=this.object,n=this.space;if("scale"===i?n="local":("E"===t||"XYZE"===t||"XYZ"===t)&&(n="world"),void 0===o||null===t||!1===this.dragging||-1!==e.button)return;g.setFromCamera(e,this.camera);let a=Z(this._plane,g,!0);if(a){if(this.pointEnd.copy(a.point).sub(this.worldPositionStart),"translate"===i)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===n&&"XYZ"!==t&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===t.indexOf("X")&&(this._offset.x=0),-1===t.indexOf("Y")&&(this._offset.y=0),-1===t.indexOf("Z")&&(this._offset.z=0),"local"===n&&"XYZ"!==t?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),o.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===n&&(o.position.applyQuaternion(b.copy(this._quaternionStart).invert()),-1!==t.search("X")&&(o.position.x=Math.round(o.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(o.position.y=Math.round(o.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(o.position.z=Math.round(o.position.z/this.translationSnap)*this.translationSnap),o.position.applyQuaternion(this._quaternionStart)),"world"===n&&(o.parent&&o.position.add(x.setFromMatrixPosition(o.parent.matrixWorld)),-1!==t.search("X")&&(o.position.x=Math.round(o.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(o.position.y=Math.round(o.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(o.position.z=Math.round(o.position.z/this.translationSnap)*this.translationSnap),o.parent&&o.position.sub(x.setFromMatrixPosition(o.parent.matrixWorld))));else if("scale"===i){if(-1!==t.search("XYZ")){let e=this.pointEnd.length()/this.pointStart.length();0>this.pointEnd.dot(this.pointStart)&&(e*=-1),v.set(e,e,e)}else x.copy(this.pointStart),v.copy(this.pointEnd),x.applyQuaternion(this._worldQuaternionInv),v.applyQuaternion(this._worldQuaternionInv),v.divide(x),-1===t.search("X")&&(v.x=1),-1===t.search("Y")&&(v.y=1),-1===t.search("Z")&&(v.z=1);o.scale.copy(this._scaleStart).multiply(v),this.scaleSnap&&(-1!==t.search("X")&&(o.scale.x=Math.round(o.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(o.scale.y=Math.round(o.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(o.scale.z=Math.round(o.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===i){this._offset.copy(this.pointEnd).sub(this.pointStart);let e=20/this.worldPosition.distanceTo(x.setFromMatrixPosition(this.camera.matrixWorld)),i=!1;"XYZE"===t?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(x.copy(this.rotationAxis).cross(this.eye))*e):("X"===t||"Y"===t||"Z"===t)&&(this.rotationAxis.copy(P[t]),x.copy(P[t]),"local"===n&&x.applyQuaternion(this.worldQuaternion),x.cross(this.eye),0===x.length()?i=!0:this.rotationAngle=this._offset.dot(x.normalize())*e),("E"===t||i)&&(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=0>this._endNorm.cross(this._startNorm).dot(this.eye)?1:-1),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===n&&"E"!==t&&"XYZE"!==t?(o.quaternion.copy(this._quaternionStart),o.quaternion.multiply(b.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),o.quaternion.copy(b.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),o.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(S),this.dispatchEvent(C)}}pointerUp(e){0===e.button&&(this.dragging&&null!==this.axis&&(E.mode=this.mode,this.dispatchEvent(E)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(S),this.dispatchEvent(C),this.pointStart.copy(this.pointEnd))}getRaycaster(){return g}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}}function Q(e){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:e.button};{let t=this.domElement.getBoundingClientRect();return{x:(e.clientX-t.left)/t.width*2-1,y:-(e.clientY-t.top)/t.height*2+1,button:e.button}}}function A(e){if(this.enabled)switch(e.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(e))}}function X(e){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(e)),this.pointerDown(this._getPointer(e)))}function z(e){this.enabled&&this.pointerMove(this._getPointer(e))}function Y(e){this.enabled&&(this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(e)))}function Z(e,t,i){let o=t.intersectObject(e,!0);for(let e=0;e<o.length;e++)if(o[e].object.visible||i)return o[e];return!1}let j=new w.Euler,G=new w.Vector3(0,1,0),V=new w.Vector3(0,0,0),L=new w.Matrix4,T=new w.Quaternion,F=new w.Quaternion,q=new w.Vector3,B=new w.Matrix4,k=new w.Vector3(1,0,0),O=new w.Vector3(0,1,0),H=new w.Vector3(0,0,1),R=new w.Vector3,D=new w.Vector3,W=new w.Vector3;class N extends w.Object3D{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";let e=new w.MeshBasicMaterial({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new w.LineBasicMaterial({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),i=e.clone();i.opacity=.15;let o=t.clone();o.opacity=.5;let n=e.clone();n.color.setHex(0xff0000);let a=e.clone();a.color.setHex(65280);let s=e.clone();s.color.setHex(255);let r=e.clone();r.color.setHex(0xff0000),r.opacity=.5;let l=e.clone();l.color.setHex(65280),l.opacity=.5;let h=e.clone();h.color.setHex(255),h.opacity=.5;let c=e.clone();c.opacity=.25;let p=e.clone();p.color.setHex(0xffff00),p.opacity=.25,e.clone().color.setHex(0xffff00);let d=e.clone();d.color.setHex(7895160);let m=new w.CylinderGeometry(0,.04,.1,12);m.translate(0,.05,0);let u=new w.BoxGeometry(.08,.08,.08);u.translate(0,.04,0);let y=new w.BufferGeometry;y.setAttribute("position",new w.Float32BufferAttribute([0,0,0,1,0,0],3));let f=new w.CylinderGeometry(.0075,.0075,.5,3);function M(e,t){let i=new w.TorusGeometry(e,.0075,3,64,t*Math.PI*2);return i.rotateY(Math.PI/2),i.rotateX(Math.PI/2),i}f.translate(0,.25,0);let g={X:[[new w.Mesh(m,n),[.5,0,0],[0,0,-Math.PI/2]],[new w.Mesh(m,n),[-.5,0,0],[0,0,Math.PI/2]],[new w.Mesh(f,n),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new w.Mesh(m,a),[0,.5,0]],[new w.Mesh(m,a),[0,-.5,0],[Math.PI,0,0]],[new w.Mesh(f,a)]],Z:[[new w.Mesh(m,s),[0,0,.5],[Math.PI/2,0,0]],[new w.Mesh(m,s),[0,0,-.5],[-Math.PI/2,0,0]],[new w.Mesh(f,s),null,[Math.PI/2,0,0]]],XYZ:[[new w.Mesh(new w.OctahedronGeometry(.1,0),c.clone()),[0,0,0]]],XY:[[new w.Mesh(new w.BoxGeometry(.15,.15,.01),h.clone()),[.15,.15,0]]],YZ:[[new w.Mesh(new w.BoxGeometry(.15,.15,.01),r.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new w.Mesh(new w.BoxGeometry(.15,.15,.01),l.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},x={X:[[new w.Mesh(new w.CylinderGeometry(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new w.Mesh(new w.CylinderGeometry(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new w.Mesh(new w.CylinderGeometry(.2,0,.6,4),i),[0,.3,0]],[new w.Mesh(new w.CylinderGeometry(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new w.Mesh(new w.CylinderGeometry(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new w.Mesh(new w.CylinderGeometry(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new w.Mesh(new w.OctahedronGeometry(.2,0),i)]],XY:[[new w.Mesh(new w.BoxGeometry(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new w.Mesh(new w.BoxGeometry(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new w.Mesh(new w.BoxGeometry(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]]},v={START:[[new w.Mesh(new w.OctahedronGeometry(.01,2),o),null,null,null,"helper"]],END:[[new w.Mesh(new w.OctahedronGeometry(.01,2),o),null,null,null,"helper"]],DELTA:[[new w.Line(function(){let e=new w.BufferGeometry;return e.setAttribute("position",new w.Float32BufferAttribute([0,0,0,1,1,1],3)),e}(),o),null,null,null,"helper"]],X:[[new w.Line(y,o.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new w.Line(y,o.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new w.Line(y,o.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},b={XYZE:[[new w.Mesh(M(.5,1),d),null,[0,Math.PI/2,0]]],X:[[new w.Mesh(M(.5,.5),n)]],Y:[[new w.Mesh(M(.5,.5),a),null,[0,0,-Math.PI/2]]],Z:[[new w.Mesh(M(.5,.5),s),null,[0,Math.PI/2,0]]],E:[[new w.Mesh(M(.75,1),p),null,[0,Math.PI/2,0]]]},P={AXIS:[[new w.Line(y,o.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},S={XYZE:[[new w.Mesh(new w.SphereGeometry(.25,10,8),i)]],X:[[new w.Mesh(new w.TorusGeometry(.5,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new w.Mesh(new w.TorusGeometry(.5,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new w.Mesh(new w.TorusGeometry(.5,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new w.Mesh(new w.TorusGeometry(.75,.1,2,24),i)]]},_={X:[[new w.Mesh(u,n),[.5,0,0],[0,0,-Math.PI/2]],[new w.Mesh(f,n),[0,0,0],[0,0,-Math.PI/2]],[new w.Mesh(u,n),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new w.Mesh(u,a),[0,.5,0]],[new w.Mesh(f,a)],[new w.Mesh(u,a),[0,-.5,0],[0,0,Math.PI]]],Z:[[new w.Mesh(u,s),[0,0,.5],[Math.PI/2,0,0]],[new w.Mesh(f,s),[0,0,0],[Math.PI/2,0,0]],[new w.Mesh(u,s),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new w.Mesh(new w.BoxGeometry(.15,.15,.01),h),[.15,.15,0]]],YZ:[[new w.Mesh(new w.BoxGeometry(.15,.15,.01),r),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new w.Mesh(new w.BoxGeometry(.15,.15,.01),l),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new w.Mesh(new w.BoxGeometry(.1,.1,.1),c.clone())]]},E={X:[[new w.Mesh(new w.CylinderGeometry(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new w.Mesh(new w.CylinderGeometry(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new w.Mesh(new w.CylinderGeometry(.2,0,.6,4),i),[0,.3,0]],[new w.Mesh(new w.CylinderGeometry(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new w.Mesh(new w.CylinderGeometry(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new w.Mesh(new w.CylinderGeometry(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new w.Mesh(new w.BoxGeometry(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new w.Mesh(new w.BoxGeometry(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new w.Mesh(new w.BoxGeometry(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new w.Mesh(new w.BoxGeometry(.2,.2,.2),i),[0,0,0]]]},C={X:[[new w.Line(y,o.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new w.Line(y,o.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new w.Line(y,o.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function I(e){let t=new w.Object3D;for(let i in e)for(let o=e[i].length;o--;){let n=e[i][o][0].clone(),a=e[i][o][1],s=e[i][o][2],r=e[i][o][3],l=e[i][o][4];n.name=i,n.tag=l,a&&n.position.set(a[0],a[1],a[2]),s&&n.rotation.set(s[0],s[1],s[2]),r&&n.scale.set(r[0],r[1],r[2]),n.updateMatrix();let h=n.geometry.clone();h.applyMatrix4(n.matrix),n.geometry=h,n.renderOrder=1/0,n.position.set(0,0,0),n.rotation.set(0,0,0),n.scale.set(1,1,1),t.add(n)}return t}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=I(g)),this.add(this.gizmo.rotate=I(b)),this.add(this.gizmo.scale=I(_)),this.add(this.picker.translate=I(x)),this.add(this.picker.rotate=I(S)),this.add(this.picker.scale=I(E)),this.add(this.helper.translate=I(v)),this.add(this.helper.rotate=I(P)),this.add(this.helper.scale=I(C)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){let t="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:F;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let i=[];i=(i=(i=i.concat(this.picker[this.mode].children)).concat(this.gizmo[this.mode].children)).concat(this.helper[this.mode].children);for(let e=0;e<i.length;e++){let o,n=i[e];if(n.visible=!0,n.rotation.set(0,0,0),n.position.copy(this.worldPosition),o=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),n.scale.set(1,1,1).multiplyScalar(o*this.size/4),"helper"===n.tag){n.visible=!1,"AXIS"===n.name?(n.visible=!!this.axis,"X"===this.axis&&(b.setFromEuler(j.set(0,0,0)),n.quaternion.copy(t).multiply(b),Math.abs(G.copy(k).applyQuaternion(t).dot(this.eye))>.9&&(n.visible=!1)),"Y"===this.axis&&(b.setFromEuler(j.set(0,0,Math.PI/2)),n.quaternion.copy(t).multiply(b),Math.abs(G.copy(O).applyQuaternion(t).dot(this.eye))>.9&&(n.visible=!1)),"Z"===this.axis&&(b.setFromEuler(j.set(0,Math.PI/2,0)),n.quaternion.copy(t).multiply(b),Math.abs(G.copy(H).applyQuaternion(t).dot(this.eye))>.9&&(n.visible=!1)),"XYZE"===this.axis&&(b.setFromEuler(j.set(0,Math.PI/2,0)),G.copy(this.rotationAxis),n.quaternion.setFromRotationMatrix(L.lookAt(V,G,O)),n.quaternion.multiply(b),n.visible=this.dragging),"E"===this.axis&&(n.visible=!1)):"START"===n.name?(n.position.copy(this.worldPositionStart),n.visible=this.dragging):"END"===n.name?(n.position.copy(this.worldPosition),n.visible=this.dragging):"DELTA"===n.name?(n.position.copy(this.worldPositionStart),n.quaternion.copy(this.worldQuaternionStart),x.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),x.applyQuaternion(this.worldQuaternionStart.clone().invert()),n.scale.copy(x),n.visible=this.dragging):(n.quaternion.copy(t),this.dragging?n.position.copy(this.worldPositionStart):n.position.copy(this.worldPosition),this.axis&&(n.visible=-1!==this.axis.search(n.name)));continue}n.quaternion.copy(t),"translate"===this.mode||"scale"===this.mode?("X"===n.name&&Math.abs(G.copy(k).applyQuaternion(t).dot(this.eye))>.99&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1),"Y"===n.name&&Math.abs(G.copy(O).applyQuaternion(t).dot(this.eye))>.99&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1),"Z"===n.name&&Math.abs(G.copy(H).applyQuaternion(t).dot(this.eye))>.99&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1),"XY"===n.name&&.2>Math.abs(G.copy(H).applyQuaternion(t).dot(this.eye))&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1),"YZ"===n.name&&.2>Math.abs(G.copy(k).applyQuaternion(t).dot(this.eye))&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1),"XZ"===n.name&&.2>Math.abs(G.copy(O).applyQuaternion(t).dot(this.eye))&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1)):"rotate"===this.mode&&(T.copy(t),G.copy(this.eye).applyQuaternion(b.copy(t).invert()),-1!==n.name.search("E")&&n.quaternion.setFromRotationMatrix(L.lookAt(this.eye,V,O)),"X"===n.name&&(b.setFromAxisAngle(k,Math.atan2(-G.y,G.z)),b.multiplyQuaternions(T,b),n.quaternion.copy(b)),"Y"===n.name&&(b.setFromAxisAngle(O,Math.atan2(G.x,G.z)),b.multiplyQuaternions(T,b),n.quaternion.copy(b)),"Z"===n.name&&(b.setFromAxisAngle(H,Math.atan2(G.y,G.x)),b.multiplyQuaternions(T,b),n.quaternion.copy(b))),n.visible=n.visible&&(-1===n.name.indexOf("X")||this.showX),n.visible=n.visible&&(-1===n.name.indexOf("Y")||this.showY),n.visible=n.visible&&(-1===n.name.indexOf("Z")||this.showZ),n.visible=n.visible&&(-1===n.name.indexOf("E")||this.showX&&this.showY&&this.showZ),n.material._color=n.material._color||n.material.color.clone(),n.material._opacity=n.material._opacity||n.material.opacity,n.material.color.copy(n.material._color),n.material.opacity=n.material._opacity,this.enabled&&this.axis&&(n.name===this.axis?(n.material.color.setHex(0xffff00),n.material.opacity=1):this.axis.split("").some(function(e){return n.name===e})&&(n.material.color.setHex(0xffff00),n.material.opacity=1))}super.updateMatrixWorld(e)}}class U extends w.Mesh{constructor(){super(new w.PlaneGeometry(1e5,1e5,2,2),new w.MeshBasicMaterial({visible:!1,wireframe:!0,side:w.DoubleSide,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),R.copy(k).applyQuaternion("local"===t?this.worldQuaternion:F),D.copy(O).applyQuaternion("local"===t?this.worldQuaternion:F),W.copy(H).applyQuaternion("local"===t?this.worldQuaternion:F),G.copy(D),this.mode){case"translate":case"scale":switch(this.axis){case"X":G.copy(this.eye).cross(R),q.copy(R).cross(G);break;case"Y":G.copy(this.eye).cross(D),q.copy(D).cross(G);break;case"Z":G.copy(this.eye).cross(W),q.copy(W).cross(G);break;case"XY":q.copy(W);break;case"YZ":q.copy(R);break;case"XZ":G.copy(W),q.copy(D);break;case"XYZ":case"E":q.set(0,0,0)}break;default:q.set(0,0,0)}0===q.length()?this.quaternion.copy(this.cameraQuaternion):(B.lookAt(x.set(0,0,0),q,G),this.quaternion.setFromRotationMatrix(B)),super.updateMatrixWorld(e)}}var $=u("7DqNw");let J=(0,u("2Tb7o").getAssetURL)()+"models/collision-world.glb",K=[new w.Vector3(13.656463381771713,14.283809732883363,-7.668193169056049),new w.Vector3(.9998577232602041,5.256311262739087,3.9526593933678797),new w.Vector3(5.003802510959054,-.6844364277972178,11.729153299298071),new w.Vector3(-2.0803289556393207,-.36919658334801253,10.97966816333047)],ee=[],et=[],ei={},eo=200,en=new w.Vector2,ea=window.innerWidth,es=window.innerHeight,er=!1,el={center:new w.Vector3,min:new w.Vector3,max:new w.Vector3},eh=new w.Group,ec=new w.BoxGeometry(.5,.5,.5),ep=new w.MeshLambertMaterial({color:0xffffff*Math.random()}),ed={},em={showCurve:!0,tension:.5,arcSegments:eo,curveType:"uniform",showHelper:!0,aspect:ea/es,near:1,far:50,fov:20,addPoint:function(){let{size:e,center:t,min:i,max:o}=el;ew(new w.Vector3(Math.random()*e.x+i.x,Math.random()*e.y+t.y,Math.random()*e.z+i.z),(e,t)=>{K.push(e.position)}),et=eg(),eu(),ef()},removePoint:function(){if(K.length<=3){alert("Can't not remove from points less than 3.");return}let e=eh.children;K.pop();let t=e.pop();a.object&&t.uuid===a.object.uuid&&a.detach(),t.dispose&&t.dispose(),eM(2,K.length-2),et=eg(),eu(),ef()},exportSpline:function(){let e=[],t=eh.children,i=t.length;for(let o=0;o<i;o++){let i=t[o].position;e.push(`new THREE.Vector3(${i.x}, ${i.y}, ${i.z})`)}console.log(e.join(",\n")),prompt("copy and paste code","["+e.join(",\n	")+"]")},easing:"Linear",easingType:"In",stride:.001,play:function(){h||(h=function*(){let{arcSegments:e,curveType:t,stride:i,easing:o,easingType:n,progress:a}=em,l=y.Easing[o];for("generatePow"==o&&(l=l());a<=1;){let t=ee.length,o=l[n](a)*e&0x7fffffff;o>=t-1&&(o=t-2);let h=o+1,c=ee[o],p=ee[h];s.position.copy(c),s.lookAt(p),s.updateProjectionMatrix(),r.update(),a+=i,yield a}}()),er||function e(){if(l=requestAnimationFrame(e),em.pause)return;let t=h&&h.next();t&&(t.done?(ey(0),em.progress=1):em.progress=t.value,c.updateDisplay(),ef())}(),er=!0},pause:!1,reset:ey,progress:0,scale:.33,top:0,left:0,clearColor:6710886};function eu(){let e=new w.Vector3,t=em.arcSegments,i=eo!=t;for(let o in ei){let n=ei[o],a=n.mesh.geometry,s=a.attributes.position;i&&(a.setAttribute("position",new w.BufferAttribute(new Float32Array(3*t),3)),s=a.attributes.position);for(let i=0;i<t;i++){let o=i/(t-1);n.getPoint(o,e),s.setXYZ(i,e.x,e.y,e.z)}s.needsUpdate=!0}}function ew(e,t){let i=K.length,o=new w.Mesh(ec,ep);o.position.setX(e.x),o.position.setY(e.y),o.position.setZ(e.z),o.castShadow=!0,o.receiveShadow=!0,eh.add(o),t&&t(o,i)}function ey(e=!0){em.progress=0,c.updateDisplay(),l&&cancelAnimationFrame(l),h=null,er=!1,e&&eM(),ef()}function ef(){for(let o of function(){let{clearColor:t,scale:i,top:o,left:n}=em;return[{name:"main",camera:e,width:ea,height:es,left:0,top:0,clearColor:3355443},{name:"preview",camera:s,width:i*ea,height:i*es,left:n,top:es*(1-i)-o,clearColor:t}]}()){let{clearColor:e,left:n,top:a,width:s,height:r,camera:l}=o;i.setClearColor(e,1),i.setScissor(n,a,s,r),i.setViewport(n,a,s,r),i.setScissorTest(!0),i.render(t,l)}}function eM(e=0,t=0){let i=t,o=t+1;switch(e){case 0:p(0,1,K);break;case 1:t==eo&&(i-=1,o-=1),p(i,o,et);break;case 2:t==K.length&&(i-=1,o-=1),p(i,o,K);break;case 3:if(et.length<2)return;p(0,1,et)}let{showHelper:n,fov:a,near:l,far:h,aspect:c}=em;function p(e,t,i){s.position.copy(i[e]),s.lookAt(i[t]),s.updateProjectionMatrix(),r.update()}s.aspect=c,s.fov=a,s.near=l,s.far=h,s.updateProjectionMatrix(),r.visible=n,r.update()}function eg(){let{arcSegments:e,curveType:t,progress:i}=em;if(ee=ei[t].getPoints(e),0===i)return ee;let o=ei[t].getPoints(e,1===i?.99:i,1),n=i*e&0xfffffff;return o.splice(n,e-1)}!function(){(i=new w.WebGLRenderer({antialias:!1})).setPixelRatio(window.devicePixelRatio),i.setSize(ea,es),i.setClearColor(3355443,1),document.body.appendChild(i.domElement),(t=new w.Scene).add(new w.AmbientLight(0xf0f0f0,3)),t.add(eh),e=new w.PerspectiveCamera(70,ea/es,1,1e3);let{aspect:l,near:h,far:p,fov:d,showHelper:m}=em;s=new w.PerspectiveCamera(d,l,h,p),(r=new w.CameraHelper(s)).visible=m,t.add(e),t.add(s),t.add(r),o=new M.OrbitControls(e,i.domElement),n=new w.Raycaster,a=new I(e,i.domElement),t.add(a),new(0,f.GLTFLoader)().load(J,function(i){let n=i.scene;t.add(n);let a=new w.Box3;a.setFromObject(n);let s=a.getSize(new w.Vector3),r=a.getCenter(o.target);el.min=a.min,el.max=a.max,el.center=r,el.size=s,e.position.x=r.x-s.x/2,e.position.y=2*s.y,e.position.z=r.z-s.z/2,e.updateProjectionMatrix(),o.update();let l=new w.SpotLight(0xffffff,4.5);l.position.set(r.x,50*r.y,r.z),l.lookAt(r.x,r.y,r.z),l.angle=.2*Math.PI,l.decay=0,l.castShadow=!0,l.shadow.camera.near=200,l.shadow.camera.far=2e3,l.shadow.bias=-222e-6,l.shadow.mapSize.width=1024,l.shadow.mapSize.height=1024,t.add(l);{if(0==K.length){K.length=0;let{center:e,min:t,max:i,size:o}=el;for(let i=0;i<3;++i){let i=new w.Vector3(Math.random()*o.x+t.x,Math.random()*o.y+e.y,Math.random()*o.z+t.z);K.push(i)}}for(let e of K)ew(e);eM();let e=eh.children,i=e.length;K.length=0;for(let t=0;t<i;++t)K[t]=e[t].position;let o=new w.BufferGeometry;o.setAttribute("position",new w.BufferAttribute(new Float32Array(3*eo),3));let n=new w.CatmullRomCurve3(K);for(let e in n.curveType="catmullrom",n.mesh=new w.Line(o.clone(),new w.LineBasicMaterial({color:0xff0000,opacity:.35})),n.mesh.castShadow=!0,ei.uniform=n,(n=new w.CatmullRomCurve3(K)).curveType="centripetal",n.mesh=new w.Line(o.clone(),new w.LineBasicMaterial({color:65280,opacity:.35})),n.mesh.castShadow=!0,ei.centripetal=n,(n=new w.CatmullRomCurve3(K)).curveType="chordal",n.mesh=new w.Line(o.clone(),new w.LineBasicMaterial({color:255,opacity:.35})),n.mesh.castShadow=!0,ei.chordal=n,ei){let i=ei[e];t.add(i.mesh)}et=eg(),eu(),ef()}},function(e){},function(e){console.log(e)});{let e=new $.GUI,t=e.addFolder("Spline");t.add(em,"showCurve").onChange(e=>{for(let t in ei)ei[t].mesh.visible=e;ef()}),t.add(em,"curveType",["centripetal","uniform","chordal"]).onChange(ef),t.add(em,"tension",0,1).step(.01).onChange(e=>{for(let t in ei)ei[t].tension=e;eu(),ef()}),t.add(em,"arcSegments",100,5e3).step(100).onChange(e=>{for(let t in ei)ei[t].arcLengthDivisions=e;eu(),ef(),eo=e}),ed.splineFolder=t;let i=e.addFolder("Camera Helper");i.add(em,"showHelper").onChange(e=>{eh.traverse(t=>{t.visible=e}),eM(),ef()}),i.add(em,"aspect",1,10).step(.1).onChange(e=>{eM(),ef()}),i.add(em,"fov",0,180).step(1).onChange(e=>{eM(),ef()}),i.add(em,"near",1,200).step(1).onChange(e=>{eM(),ef()}),i.add(em,"far",500,2e3).step(1).onChange(e=>{eM(),ef()}),ed.helperFolder=i;let o=e.addFolder("Edit");o.add(em,"addPoint"),o.add(em,"removePoint"),o.add(em,"exportSpline"),ed.editFolder=o;let n=e.addFolder("Animation"),a=[];for(let e in y.Easing)a.push(e);n.add(em,"easing",a),n.add(em,"easingType",["In","InOut","Out"]),n.add(em,"stride",.001,.1).step(1e-4),n.add(em,"play"),n.add(em,"pause"),n.add(em,"reset"),n.add(em,"progress",0,1).step(.01).onChange(e=>{et=eg(),eM(3),ef()}),ed.animationFolder=n;let s=e.addFolder("Viewport");s.add(em,"scale",.1,.5).step(.01).onChange(e=>{ef()}),s.add(em,"top",0,es).step(10).onChange(e=>{ef()}),s.add(em,"left",0,ea).step(10).onChange(e=>{ef()}),s.addColor(em,"clearColor").onChange(e=>{ef()}),ed.viewportFolder=s,c=ed.animationFolder.children[6],e.open()}a.addEventListener("dragging-changed",e=>{o.enabled=!e.value}),a.addEventListener("objectChange",e=>{et=eg(),eu(),er||eM(3)}),window.addEventListener("resize",()=>{ea=window.innerWidth,es=window.innerHeight,i.setPixelRatio(window.devicePixelRatio),i.setSize(ea,es);let t=ea/es;e.aspect=t,s.aspect=t,e.updateProjectionMatrix(),s.updateProjectionMatrix(),r.update(),ef()}),window.addEventListener("contextmenu",t=>{n.setFromCamera(en,e);let i=a.children[0];0==n.intersectObjects([...eh.children,i],!1).length&&a.detach(),ef()}),window.addEventListener("mousewheel",()=>{ef()}),window.addEventListener("mousemove",t=>{en.x=t.clientX/ea*2-1,en.y=-(2*(t.clientY/es))+1,n.setFromCamera(en,e);let i=n.intersectObjects(eh.children,!1);if(i.length>0){let e=i[0].object;if(a.dragging)return;e!==a.object&&a.attach(e)}ef()})}();
//# sourceMappingURL=cameraEditor.133965dc.js.map
